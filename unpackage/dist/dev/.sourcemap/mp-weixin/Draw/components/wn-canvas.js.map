{"version":3,"sources":["webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?ba94","webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?99fa","webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?e29f","webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?d8a8","uni-app:///Draw/components/wn-canvas.vue","webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?014a","webpack:///D:/我的文档/Documents/项目/uniapp/Emovision-uniapp/Emovision-uniapp/Draw/components/wn-canvas.vue?beba"],"names":["name","components","color","data","colorShow","drawContext","historyList","startX","startY","lastX","lastY","mode","currentColor","bgColor","lineWidth","lastRect","lastCircle","tools","title","key","url","activeUrl","active","toolsShow","isLandScape","aspectRatio","props","showSave","type","default","drawImage","saveImageType","isUnderBkg","mounted","methods","colorShowHandel","chooseTools","console","i","showTools","penWidthChange","penBegin","drawPen","lineBegin","lineDraw","lineEnd","rectFillBegin","rectBegin","circleFillBegin","circleBegin","drawRectFill","drawRect","pointLT","pointRB","pointRT","pointLB","x","y","width","height","clearLastRect","Y","clearLastCircle","clearArc","cxt","stepClear","drawCircleFill","center","drawCircle","touchStart","e","style","coordinates","touchMove","touchEnd","backHandle","drawHistory","item","switchModeToLine","colorPickTapHandler","downloadHandle","uni","canvasId","success","filePath","that","fail","saveImage","saveImageUrl","query","fillBackground","draw","cb","setBoardMode","clearBoard","initBoard","systemInfo","src","imageInfoObj"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsH;AACtH;AAC6D;AACL;AACc;;;AAGtE;AAC6L;AAC7L,gBAAgB,2LAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,oFAAM;AACR,EAAE,6FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAwuB,CAAgB,yrBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;eCwC5vB;EACAA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACA;MACAC;QACAC;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;QACAC;MACA,GACA;QACAJ;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,GAEA;QACAH;QACAC;QACAC;QACAC;MACA,GACA;QACAH;QACAC;QACAC;QACAC;MACA,EACA;MACAE;MACAC;MAAA;MACAC;IAEA;EACA;;EACAC;IACAC;MAAA;MACAC;MACAC;IACA;IACAC;MAAA;MACAF;MACAC;IACA;IACAE;MAAA;MACAH;MACAC;IACA;IACAG;MAAA;MACAJ;MACAC;IACA;EACA;EACAI;IACA;IACA;EAEA;EACAC;IACAC;MACA;IACA;IACAC;MACAC;MACA;MACA;QACA;QACA;QACA;MACA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;;QAEA;MACA;MAEA;QACA;QACA;QACA;MAEA;MACA;MACA;QACAC;QACA;UACAA;QACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;IACAC;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;IACAC;MAAA;MACA;MACA;MACA;MACA;MACA;MAEAC;MACAA;MAEAC;MACAA;MAEAC;MACAA;MAGAC;MACAA;MAEA;MACA;MACA;MACA;MACA;MACA;MAEA;QACAC;QACAC;QACAC;QACAC;QACAP;MACA;MACA;IACA;IAEAQ;MACA,+FACAC,SACA/C,iFACAA;IACA;IACAgD;MACA;MACA;MACAC;MAEA;QACA;QACA;QAEA;QACA;QAEA;QACA;QAEA;UACAC;UACAC;UACAF;QACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAG;MAAA;MACA;MACA;MACA;MACA;MACA;MAEAd;MACAA;MAEAC;MACAA;MAEAC;MACAA;MAEAC;MACAA;MAEAY;MACAA;MAEA;MACA;MACA;MAEA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MAAA;MACA;MACA;MACA;MAEAhB;MACAA;MAEAC;MACAA;MAEAc;MACAA;MAEA;MACA;MACA;MAEA;MAEA;MAEA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAE;MACA,kBAGAC;QAFAd;QACAC;MAEApB;MACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;MAAA;MAEA;MACA;QACAkC;UACArE;UACAwD;QACA;QACAc;UACA5C;UACAjB;UACA6C;UACAC;QACA;MACA;IACA;IACA;IACAgB;MACA,mBAGAH;QAFAd;QACAC;MAEA;MACA;MACApB;MACA;QACA;UACA;UACA;UACA;QACA;UACA;UACA;UACA;QACA;UACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;MAAA;;MAGA;MACA;QACAT;QACAjB;QACA6C;QACAC;MACA;IACA;IACA;IACAiB;MACA,yBAGAJ;QAFAd;QACAC;MAEApB;MACA;QACA;UACA;UACA;QACA;UACA;UACA;UACA;QACA;UACA;YACAT;YACAjB;YACA6C;YACAC;UACA;UACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;QACA;UACA;UACA;MAAA;IAEA;IACA;IACAkB;MACA;MACA;MACA;IACA;IACAC;MAAA;MACA;MACA;QACA;QACA;QACA;QACA;QACAC;UACA;YACA;UACA;YACA;UACA;QACA;QACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACA;UACA;QACA;UACA;QACA;MACA;QACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;QACA;UACA;UACA;QACA;UACA;QACA;MAEA;QACA;UACA;UACA;QACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MAAA;MACA1C;MACA;MACA;QACAwC;QACA;UACA;UACAA;QACA;MACA;MAEA;MACA;IACA;IACA;IACAG;MACA;MACA;QACA;MACA;MACA;QACAC;UACAC;UACAC;YACA9C;YACA;YACA4C;cACAG;cACAD;gBACA9C;gBACAgD;cACA;cACAC;gBACAjD;gBACAgD;cACA;YACA;UACA;QACA;MACA;IACA;IACA;IACAE;MACA;MACA;QACAF;MACA;QACAJ;UACAC;UACAC;YACA9C;YACAgD;UACA;QACA;MACA;IAEA;IACAG;MAAA;MACA;MACA;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACAR;UACAC;UACAC;YACAE;UACA;QACA;MAEA;IAEA;IACA;IACAK;MAAA;MACA;MACAD;QACA;QACA;QACA;QACA;UACA;QACA;QACA;MACA;IACA;IACA;IACA;IACAE;MAAA;MAAA;MACA;QACA;UACAC;QACA;MACA;IACA;IACAC;MAAA;MACA;QACAvD;QACA;UACAA;UACA;QACA;MACA;IACA;IACA;IACAwD;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAEAC;gBACA;kBACA;gBACA;kBACA;gBACA;gBAEA3D;gBAAA;gBAAA,OACA4C;kBACAgB;gBACA;cAAA;gBAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAFAC;gBAIA7D;gBACA;gBACA;kBACA;gBACA;kBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC1wBA;AAAA;AAAA;AAAA;AAA23C,CAAgB,guCAAG,EAAC,C;;;;;;;;;;;ACA/4C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"Draw/components/wn-canvas.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./wn-canvas.vue?vue&type=template&id=0efcff82&\"\nvar renderjs\nimport script from \"./wn-canvas.vue?vue&type=script&lang=js&\"\nexport * from \"./wn-canvas.vue?vue&type=script&lang=js&\"\nimport style0 from \"./wn-canvas.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Draw/components/wn-canvas.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wn-canvas.vue?vue&type=template&id=0efcff82&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wn-canvas.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wn-canvas.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"pen-box\">\r\n\t\t\t<view class=\"pen\" :style=\"{backgroundColor: currentColor, height: lineWidth+'px'}\"></view>\r\n\t\t\t<slider min=\"1\" max=\"20\" :value=\"lineWidth\" block-size=\"20\" activeColor=\"#84f876\" class=\"pen-slider\"\r\n\t\t\t\t@change=\"penWidthChange\" />\r\n\t\t\t<view class=\"pen-txt\">{{lineWidth}}px</view>\r\n\t\t</view>\r\n\t\t<image v-if=\"isLandScape\" src=\"../static/img/color.png\" mode=\"\" class=\"draw-logo\" @click=\"showTools\" ></image>\r\n\t\t<view class=\"tools-box\" v-if=\"toolsShow\">\r\n\t\t\t<view class=\"tools\">\r\n\t\t\t\t<view class=\"tools-item \" v-for=\"(item,index) in tools\" :key=\"index\">\r\n\t\t\t\t\t<button open-type=\"share\" v-if=\"item.key == 'share'\"\r\n\t\t\t\t\t\tstyle=\"background-color: rgba(0,0,0,0);padding: 0;border-radius: none;line-height: 0;borderColor:rgba(0,0,0,0);\">\r\n\t\t\t\t\t\t<image class=\"tools-icon\" :src=\"item.active?item.item.activeUrl:item.url\" mode=\"aspectFit\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<image @click=\"chooseTools(item)\" v-else :src=\"item.active?item.activeUrl:item.url\"\r\n\t\t\t\t\t\tclass=\"tools-icon\"></image>\r\n\t\t\t\t\t<!-- <text>{{item.title}}</text> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"canvas-box\" :style=\"{aspectRatio:aspectRatio}\">\r\n\t\t\t<canvas class=\"board-canvas\" canvas-id=\"drawCanvas\" disable-scroll=\"true\" @touchstart=\"touchStart\"\r\n\t\t\t\t@touchmove=\"touchMove\" @touchend=\"touchEnd\"></canvas>\r\n\t<!-- \t\t<image :src=\"drawImage\" class=\"under-image\" mode=\"\"   v-if=\"isUnderBkg\"></image> -->\r\n\t\t\t<view class=\"under-image\" v-if=\"isUnderBkg\"\r\n\t\t\t\t:style=\"{backgroundImage:`URL(${drawImage})`,aspectRatio:aspectRatio}\">\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<color :colorShow=\"colorShow\" @colorPickTap=\"colorPickTapHandler\"></color>\r\n\t\t<view class=\"btn-box\" v-if=\"showSave\">\r\n\t\t\t<button type=\"primary\" @click=\"saveImage\">保存</button>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport color from \"./color.vue\"\r\n\texport default {\r\n\t\tname: \"canvas\",\r\n\t\tcomponents: {\r\n\t\t\tcolor\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcolorShow: false, //显示颜色\r\n\t\t\t\tdrawContext: null, //画板对象\r\n\t\t\t\thistoryList: [], //路径历史\r\n\t\t\t\tstartX: 0, //起始坐标\r\n\t\t\t\tstartY: 0,\r\n\t\t\t\tlastX: 0,\r\n\t\t\t\tlastY: 0,\r\n\t\t\t\tmode: \"pen\", //操作模式\r\n\t\t\t\tcurrentColor: \"#000\", //当前画笔颜色\r\n\t\t\t\tbgColor: \"#fff\", //画板背景颜色\r\n\t\t\t\tlineWidth: 2, //画笔粗细 px\r\n\t\t\t\tlastRect: {}, //运动轨迹最后一个方形\r\n\t\t\t\tlastCircle: {}, //运动轨迹最后一个圆形\r\n\t\t\t\t//工具箱\r\n\t\t\t\ttools: [{\r\n\t\t\t\t\t\ttitle: \"清空\",\r\n\t\t\t\t\t\tkey: \"clear\",\r\n\t\t\t\t\t\turl: require(\"../static/img/clear.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/clear.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"撤回\",\r\n\t\t\t\t\t\tkey: \"back\",\r\n\t\t\t\t\t\turl: require(\"../static/img/back.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/back.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"橡皮\",\r\n\t\t\t\t\t\tkey: \"eraser\",\r\n\t\t\t\t\t\turl: require(\"../static/img/eraser.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/eraser-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"颜色\",\r\n\t\t\t\t\t\tkey: \"color\",\r\n\t\t\t\t\t\turl: require(\"../static/img/color.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/color-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"画笔\",\r\n\t\t\t\t\t\tkey: \"pen\",\r\n\t\t\t\t\t\turl: require(\"../static/img/pen.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/pen-active.png\"),\r\n\t\t\t\t\t\tactive: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"直线\",\r\n\t\t\t\t\t\tkey: \"line\",\r\n\t\t\t\t\t\turl: require(\"../static/img/line.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/line-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"圆形\",\r\n\t\t\t\t\t\tkey: \"circle\",\r\n\t\t\t\t\t\turl: require(\"../static/img/circle.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/circle-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"方形\",\r\n\t\t\t\t\t\tkey: \"rect\",\r\n\t\t\t\t\t\turl: require(\"../static/img/rect.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/rect-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"实圆\",\r\n\t\t\t\t\t\tkey: \"circle-fill\",\r\n\t\t\t\t\t\turl: require(\"../static/img/circle-fill.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/circle-fill-active.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"实方\",\r\n\t\t\t\t\t\tkey: \"rect-fill\",\r\n\t\t\t\t\t\turl: require(\"../static/img/rect-fill.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/rect-fill-active.png\")\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"下载\",\r\n\t\t\t\t\t\tkey: \"download\",\r\n\t\t\t\t\t\turl: require(\"../static/img/download.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/download.png\")\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"分享\",\r\n\t\t\t\t\t\tkey: \"share\",\r\n\t\t\t\t\t\turl: require(\"../static/img/share.png\"),\r\n\t\t\t\t\t\tactiveUrl: require(\"../static/img/share.png\")\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\ttoolsShow: true,\r\n\t\t\t\tisLandScape: false, //是否横屏\r\n\t\t\t\taspectRatio: 1,//图片宽高比\r\n\r\n\t\t\t};\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\tshowSave: { //是否显示保存按钮\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tdrawImage: { //背景图片\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"\"\r\n\t\t\t},\r\n\t\t\tsaveImageType: { //保存图片的类型 1、保存地址 2、保存到本地图片 3、既保存地址 又保存图片\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: \"1\"\r\n\t\t\t},\r\n\t\t\tisUnderBkg: { //背景图片是否在画板下边，在下边则无法被擦除\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted(opt) {\r\n\t\t\tthis.drawContext = uni.createCanvasContext('drawCanvas', this);\r\n\t\t\tthis.initBoard();\r\n\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tcolorShowHandel() {\r\n\t\t\t\tthis.colorShow = !this.colorShow;\r\n\t\t\t},\r\n\t\t\tchooseTools(item) {\r\n\t\t\t\tconsole.log(item);\r\n\t\t\t\tthis.colorShow = false;\r\n\t\t\t\tif (item.key == \"back\") {\r\n\t\t\t\t\t//撤回\r\n\t\t\t\t\tthis.backHandle()\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (item.key == \"clear\") {\r\n\t\t\t\t\t//清空\r\n\t\t\t\t\tthis.clearBoard()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.key == \"eraser\") {\r\n\t\t\t\t\tthis.drawContext.strokeStyle = this.bgColor;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.key == \"color\") {\r\n\t\t\t\t\t//选择颜色\r\n\r\n\t\t\t\t\tthis.colorShowHandel()\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (item.key == \"download\") {\r\n\t\t\t\t\t//下载\r\n\t\t\t\t\tthis.downloadHandle()\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.mode = item.key;\r\n\t\t\t\tthis.tools.forEach((i, j) => {\r\n\t\t\t\t\ti.active = false\r\n\t\t\t\t\tif (item.key == i.key) {\r\n\t\t\t\t\t\ti.active = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowTools() {\r\n\t\t\t\tthis.toolsShow = !this.toolsShow\r\n\t\t\t},\r\n\t\t\tpenWidthChange(e) {\r\n\t\t\t\tthis.lineWidth = e.detail.value;\r\n\t\t\t\tthis.drawContext.setLineWidth(this.lineWidth);\r\n\t\t\t},\r\n\t\t\t//开始绘制曲线\r\n\t\t\tpenBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t\tthis.drawContext.moveTo(this.startX, this.startY)\r\n\t\t\t\tthis.drawPen(x, y);\r\n\t\t\t},\r\n\t\t\t// 绘制线条中间添加点\r\n\t\t\tdrawPen(x, y) {\r\n\t\t\t\tthis.drawContext.moveTo(this.startX, this.startY)\r\n\t\t\t\tthis.drawContext.lineTo(x, y);\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t// 开始绘制线条 (直线)\r\n\t\t\tlineBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t//画直线\r\n\t\t\tlineDraw(x, y) {\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.drawContext.moveTo(this.startX, this.startY)\r\n\t\t\t\tthis.drawContext.lineTo(x, y);\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\tthis.drawContext.draw(true);\r\n\t\t\t},\r\n\t\t\t// 绘制线条结束\r\n\t\t\tlineEnd() {\r\n\t\t\t\tthis.drawContext.closePath();\r\n\t\t\t\tthis.begin = false;\r\n\t\t\t},\r\n\t\t\t//实心方形开始绘制\r\n\t\t\trectFillBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t//方形开始绘制\r\n\t\t\trectBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t//实心圆形开始绘制\r\n\t\t\tcircleFillBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t//圆形开始绘制\r\n\t\t\tcircleBegin(x, y) {\r\n\t\t\t\tthis.begin = true;\r\n\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\tthis.startX = x;\r\n\t\t\t\tthis.startY = y;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画实体矩形\r\n\t\t\t */\r\n\t\t\tdrawRectFill(x, y, isReverse = true) {\r\n\t\t\t\tlet width = (x - this.startX) ? (x - this.startX) : (this.startX - x);\r\n\t\t\t\tlet height = (y - this.startY) ? (y - this.startY) : (this.startY - y);\r\n\t\t\t\tthis.drawContext.rect(this.startX, this.startY, width, height);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\tthis.draw(isReverse);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画空心矩形\r\n\t\t\t * 方法是根据四个坐标点画\r\n\t\t\t * 四条线进行连接\r\n\t\t\t */\r\n\t\t\tdrawRect(x, y, isReverse = true) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet pointRT = {};\r\n\t\t\t\tlet pointLB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRT.X = pointRB.X;\r\n\t\t\t\tpointRT.Y = pointLT.Y;\r\n\r\n\r\n\t\t\t\tpointLB.X = pointLT.X;\r\n\t\t\t\tpointLB.Y = pointRB.Y;\r\n\r\n\t\t\t\tlet width = (x - this.startX) ? (x - this.startX) : (this.startX - x);\r\n\t\t\t\tlet height = (y - this.startY) ? (y - this.startY) : (this.startY - y);\r\n\t\t\t\tthis.drawContext.rect(this.startX, this.startY, width, height);\r\n\t\t\t\tthis.drawContext.setStrokeStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.stroke();\r\n\t\t\t\tthis.draw(isReverse);\r\n\r\n\t\t\t\tthis.lastRect = {\r\n\t\t\t\t\tx: this.startX,\r\n\t\t\t\t\ty: this.startY,\r\n\t\t\t\t\twidth: Math.abs(width),\r\n\t\t\t\t\theight: Math.abs(height),\r\n\t\t\t\t\tpointLT: pointLT\r\n\t\t\t\t}\r\n\t\t\t\tthis.clearLastRect()\r\n\t\t\t},\r\n\r\n\t\t\tclearLastRect() {\r\n\t\t\t\tthis.drawContext.clearRect(this.lastRect.pointLT.X + this.lineWidth / 2, this.lastRect.pointLT\r\n\t\t\t\t\t.Y + this\r\n\t\t\t\t\t.lineWidth / 2, this.lastRect.width - this.lineWidth, this.lastRect.height - this\r\n\t\t\t\t\t.lineWidth);\r\n\t\t\t},\r\n\t\t\tclearLastCircle(x, y, r, cxt) {\r\n\t\t\t\t//(x,y)为要清除的圆的圆心，r为半径，cxt为context\r\n\t\t\t\tvar stepClear = 1; //别忘记这一步  \r\n\t\t\t\tclearArc(x, y, r);\r\n\r\n\t\t\t\tfunction clearArc(x, y, radius) {\r\n\t\t\t\t\tvar calcWidth = radius - stepClear;\r\n\t\t\t\t\tvar calcHeight = Math.sqrt(radius * radius - calcWidth * calcWidth);\r\n\r\n\t\t\t\t\tvar posX = x - calcWidth;\r\n\t\t\t\t\tvar posY = y - calcHeight;\r\n\r\n\t\t\t\t\tvar widthX = 2 * calcWidth;\r\n\t\t\t\t\tvar heightY = 2 * calcHeight;\r\n\r\n\t\t\t\t\tif (stepClear <= radius) {\r\n\t\t\t\t\t\tcxt.clearRect(posX, posY, widthX, heightY);\r\n\t\t\t\t\t\tstepClear += 1;\r\n\t\t\t\t\t\tclearArc(x, y, radius);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画\r\n\t\t\t * 实心圆\r\n\t\t\t */\r\n\t\t\tdrawCircleFill(x, y, isReverse = true) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet pointRT = {};\r\n\t\t\t\tlet pointLB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRT.X = pointRB.X;\r\n\t\t\t\tpointRT.Y = pointLT.Y;\r\n\r\n\t\t\t\tpointLB.X = pointLT.X;\r\n\t\t\t\tpointLB.Y = pointRB.Y;\r\n\r\n\t\t\t\tcenter.X = (pointRB.X + pointLT.X) / 2;\r\n\t\t\t\tcenter.Y = (pointRB.Y + pointLT.Y) / 2;\r\n\r\n\t\t\t\tlet dx = pointRB.X - pointLT.X;\r\n\t\t\t\tlet dy = pointRB.Y - pointLT.Y;\r\n\t\t\t\tlet r = Math.sqrt(dx * dx + dy * dy) / 2;\r\n\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r, 0, 2 * Math.PI);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.currentColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\tthis.draw(isReverse);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 这里是画\r\n\t\t\t * 空心圆\r\n\t\t\t */\r\n\t\t\tdrawCircle(x, y, isReverse = true) {\r\n\t\t\t\tlet pointLT = {};\r\n\t\t\t\tlet pointRB = {};\r\n\t\t\t\tlet center = {};\r\n\r\n\t\t\t\tpointLT.X = (this.startX <= x) ? this.startX : x;\r\n\t\t\t\tpointLT.Y = (this.startY <= y) ? this.startY : y;\r\n\r\n\t\t\t\tpointRB.X = (this.startX >= x) ? this.startX : x;\r\n\t\t\t\tpointRB.Y = (this.startY >= y) ? this.startY : y;\r\n\r\n\t\t\t\tcenter.X = (pointRB.X + pointLT.X) / 2;\r\n\t\t\t\tcenter.Y = (pointRB.Y + pointLT.Y) / 2;\r\n\r\n\t\t\t\tlet dx = pointRB.X - pointLT.X;\r\n\t\t\t\tlet dy = pointRB.Y - pointLT.Y;\r\n\t\t\t\tlet r = Math.sqrt(dx * dx + dy * dy) / 2;\r\n\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r, 0, 2 * Math.PI);\r\n\r\n\t\t\t\tthis.drawContext.stroke();\r\n\r\n\t\t\t\tthis.drawContext.beginPath();\r\n\t\t\t\tthis.drawContext.arc(center.X, center.Y, r - this.lineWidth / 2, 0, 2 * Math.PI);\r\n\t\t\t\tthis.drawContext.setFillStyle(this.bgColor);\r\n\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\tthis.draw(isReverse);\r\n\t\t\t\tthis.clearLastCircle(center.X, center.Y, r - this.lineWidth / 2, this.drawContext);\r\n\t\t\t},\r\n\t\t\t//开始touch\r\n\t\t\ttouchStart(e) {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty\r\n\t\t\t\t} = e.touches[0]\r\n\t\t\t\tconsole.log(\"开始touch\");\r\n\t\t\t\tswitch (this.mode) {\r\n\t\t\t\t\tcase \"pen\":\r\n\t\t\t\t\t\tthis.penBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"eraser\":\r\n\t\t\t\t\t\tthis.penBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"line\":\r\n\t\t\t\t\t\tthis.lineBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect\":\r\n\t\t\t\t\t\tthis.rectBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle\":\r\n\t\t\t\t\t\tthis.circleBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect-fill\":\r\n\t\t\t\t\t\tthis.rectFillBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle-fill\":\r\n\t\t\t\t\t\tthis.circleFillBegin(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t//新增一次历史轨迹\r\n\t\t\t\tthis.historyList.push({\r\n\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\tcolor: this.currentColor,\r\n\t\t\t\t\t\twidth: this.lineWidth\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcoordinates: [{\r\n\t\t\t\t\t\ttype: e.type,\r\n\t\t\t\t\t\tmode: this.mode,\r\n\t\t\t\t\t\tx: e.touches[0].x,\r\n\t\t\t\t\t\ty: e.touches[0].y\r\n\t\t\t\t\t}]\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//touch移动\r\n\t\t\ttouchMove(e) {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty\r\n\t\t\t\t} = e.touches[0]\r\n\t\t\t\tthis.lastX = x;\r\n\t\t\t\tthis.lastY = y;\r\n\t\t\t\tconsole.log(\"touch移动\");\r\n\t\t\t\tswitch (this.mode) {\r\n\t\t\t\t\tcase \"pen\":\r\n\t\t\t\t\t\tthis.drawPen(x, y)\r\n\t\t\t\t\t\tthis.draw(true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"eraser\":\r\n\t\t\t\t\t\tthis.drawPen(x, y)\r\n\t\t\t\t\t\tthis.draw(true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"line\":\r\n\t\t\t\t\t\tthis.draw(true);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect\":\r\n\t\t\t\t\t\tthis.drawRect(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle\":\r\n\t\t\t\t\t\tthis.drawCircle(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect-fill\":\r\n\t\t\t\t\t\tthis.drawRectFill(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle-fill\":\r\n\t\t\t\t\t\tthis.drawCircleFill(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//最后一次历史中新增运动轨迹\r\n\t\t\t\tthis.historyList[this.historyList.length - 1].coordinates.push({\r\n\t\t\t\t\ttype: e.type,\r\n\t\t\t\t\tmode: this.mode,\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//touch结束\r\n\t\t\ttouchEnd(e) {\r\n\t\t\t\tlet {\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty\r\n\t\t\t\t} = e.changedTouches[0]\r\n\t\t\t\tconsole.log(\"touch结束\");\r\n\t\t\t\tswitch (this.mode) {\r\n\t\t\t\t\tcase \"pen\":\r\n\t\t\t\t\t\tthis.lineEnd()\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"eraser\":\r\n\t\t\t\t\t\tthis.drawContext.setFillStyle(this.currentColor)\r\n\t\t\t\t\t\tthis.lineEnd()\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"line\":\r\n\t\t\t\t\t\tthis.historyList[this.historyList.length - 1].coordinates.push({\r\n\t\t\t\t\t\t\ttype: e.type,\r\n\t\t\t\t\t\t\tmode: this.mode,\r\n\t\t\t\t\t\t\tx,\r\n\t\t\t\t\t\t\ty\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.lineDraw(x, y)\r\n\t\t\t\t\t\tthis.lineEnd()\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect\":\r\n\t\t\t\t\t\tthis.drawRect(x, y, true);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle\":\r\n\t\t\t\t\t\tthis.drawCircle(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"rect-fill\":\r\n\t\t\t\t\t\tthis.drawRectFill(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"circle-fill\":\r\n\t\t\t\t\t\tthis.drawCircleFill(x, y)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//撤回\r\n\t\t\tbackHandle() {\r\n\t\t\t\tthis.drawContext.draw()\r\n\t\t\t\tthis.historyList.pop(); //删除最后一步\r\n\t\t\t\tthis.drawHistory();\r\n\t\t\t},\r\n\t\t\tdrawHistory() {\r\n\t\t\t\t//遍历历史轨迹重新绘制\r\n\t\t\t\tthis.historyList.forEach((item, index) => {\r\n\t\t\t\t\tthis.drawContext.beginPath()\r\n\t\t\t\t\tthis.drawContext.setLineCap('round')\r\n\t\t\t\t\tthis.drawContext.setStrokeStyle(item.style.color)\r\n\t\t\t\t\tthis.drawContext.setLineWidth(item.style.width)\r\n\t\t\t\t\titem.coordinates.forEach(it => {\r\n\t\t\t\t\t\tif (it.type == 'touchstart') {\r\n\t\t\t\t\t\t\tthis.switchModeToLine(it.mode, 1, it.x, it.y)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.switchModeToLine(it.mode, 2, it.x, it.y)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.drawContext.stroke()\r\n\t\t\t\t})\r\n\t\t\t\tthis.drawContext.draw(true)\r\n\t\t\t},\r\n\t\t\t//重新绘制历史画面 mode:操作模式  type:touch类型（1:开始touch、2:touch中或结束touch）\r\n\t\t\tswitchModeToLine(mode, type, x, y) {\r\n\t\t\t\tthis.drawContext.setFillStyle(this.currentColor)\r\n\t\t\t\tif (mode == \"pen\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.drawContext.moveTo(x, y)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.drawContext.lineTo(x, y)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mode == \"eraser\") {\r\n\t\t\t\t\tthis.drawContext.setFillStyle(this.bgColor)\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.lineDraw(x, y, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mode == \"line\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.lineDraw(x, y, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mode == \"rect\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.drawRect(x, y, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mode == \"circle\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.drawCircle(x, y, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mode == \"rect-fill\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.drawRectFill(x, y, true)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if (mode == \"circle-fill\") {\r\n\t\t\t\t\tif (type == \"1\") {\r\n\t\t\t\t\t\tthis.startX = x\r\n\t\t\t\t\t\tthis.startY = y\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.drawCircleFill(x, y, true)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//选择画笔颜色\r\n\t\t\tcolorPickTapHandler(obj) {\r\n\t\t\t\tconsole.log('我点击的颜色:' + JSON.stringify(obj));\r\n\t\t\t\tthis.colorShow = false;\r\n\t\t\t\tthis.tools.forEach(item => {\r\n\t\t\t\t\titem.active = false;\r\n\t\t\t\t\tif (item.key === 'pen') {\r\n\t\t\t\t\t\tthis.mode = 'pen'\r\n\t\t\t\t\t\titem.active = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthis.currentColor = obj.color;\r\n\t\t\t\tthis.drawContext.strokeStyle = obj.color;\r\n\t\t\t},\r\n\t\t\t//下载图片\r\n\t\t\tdownloadHandle() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tif (this.saveImageType == 1 || this.saveImageType == 3) {\r\n\t\t\t\t\tthis.saveImage()\r\n\t\t\t\t}\r\n\t\t\t\tif (this.saveImageType == 2 || this.saveImageType == 3) {\r\n\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\tcanvasId: 'drawCanvas',\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tconsole.log('回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t// 在H5平台下，tempFilePath 为 base64\r\n\t\t\t\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('成功回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t\tthat.$emit(\"dowmloadSuc\", JSON.stringify(res))\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\t\t\t\tconsole.log('失败回调参数:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t\tthat.$emit(\"dowmloadErr\", JSON.stringify(res))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//返回图片地址  @filePath\r\n\t\t\tsaveImage() {\r\n\t\t\t\tlet that = this\r\n\t\t\t\tif (this.isUnderBkg) {\r\n\t\t\t\t\tthat.saveImageUrl()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\tcanvasId: 'drawCanvas',\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\tthat.$emit(\"saveImage\", res.tempFilePath)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this)\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tsaveImageUrl() {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tquery.select('.canvas-box').boundingClientRect(data => {\r\n\t\t\t\t\tthis.drawContext.setFillStyle(this.bgColor);\r\n\t\t\t\t\tthis.drawContext.fillRect(0, 0, data.width, data.height); //TODO context的宽和高待定\r\n\t\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\t\tthis.drawContext.drawImage(this.drawImage, 0, 0, data.width, data.height);\r\n\t\t\t\t\tthis.drawContext.draw();\r\n\t\t\t\t\tthis.drawHistory()\r\n\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\tcanvasId: 'drawCanvas',\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tthat.$emit(\"saveImage\", res.tempFilePath)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this)\r\n\r\n\t\t\t\t}).exec();\r\n\r\n\t\t\t},\r\n\t\t\t// canvas设置背景颜色\r\n\t\t\tfillBackground() {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tquery.select('.canvas-box').boundingClientRect(data => {\r\n\t\t\t\t\tthis.drawContext.setFillStyle(this.bgColor);\r\n\t\t\t\t\tthis.drawContext.fillRect(0, 0, data.width, data.height); //TODO context的宽和高待定\r\n\t\t\t\t\tthis.drawContext.fill();\r\n\t\t\t\t\tif (this.drawImage && !this.isUnderBkg) {\r\n\t\t\t\t\t\tthis.drawContext.drawImage(this.drawImage, 0, 0, data.width, data.height);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.drawContext.draw();\r\n\t\t\t\t}).exec();\r\n\t\t\t},\r\n\t\t\t// 绘制canvas\r\n\t\t\t// isReverse: 是否保留之前的像素\r\n\t\t\tdraw(isReverse = false, cb) {\r\n\t\t\t\tthis.drawContext.draw(isReverse, () => {\r\n\t\t\t\t\tif (cb && typeof(cb) == \"function\") {\r\n\t\t\t\t\t\tcb();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetBoardMode(key) {\r\n\t\t\t\tthis.tools.forEach(i => {\r\n\t\t\t\t\ti.active = false;\r\n\t\t\t\t\tif (i.key == key) {\r\n\t\t\t\t\t\ti.active = true;\r\n\t\t\t\t\t\tthis.mode = key\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//清空画板\r\n\t\t\tclearBoard() {\r\n\t\t\t\tthis.historyList = [];\r\n\t\t\t\tthis.drawContext.draw()\r\n\t\t\t},\r\n\t\t\tasync initBoard() {\r\n\t\t\t\t\n\t\t\t\tconst systemInfo = uni.getSystemInfoSync(); \n\t\t\t\tif(systemInfo.screenWidth>systemInfo.screenHeight){\n\t\t\t\t\tthis.isLandScape = true\n\t\t\t\t}else{\n\t\t\t\t\tthis.isLandScape = false\n\t\t\t\t}\n\t\t\t\t\r\n\t\t\t\tconsole.log(this.isLandScape);\r\n\t\t\t\tlet imageInfoObj = (await uni.getImageInfo({\r\n\t\t\t\t\tsrc: this.drawImage\r\n\t\t\t\t}))[1] || {};\r\n\r\n\t\t\t\tconsole.log(imageInfoObj);\r\n\t\t\t\tthis.aspectRatio = imageInfoObj.width / imageInfoObj.height;\r\n\t\t\t\tif (this.isUnderBkg) {\r\n\t\t\t\t\tthis.bgColor = \"rgba(0,0,0,0)\"\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.bgColor = \"rgb(255,255,255)\"\r\n\t\t\t\t}\r\n\t\t\t\tthis.drawContext.setLineCap('round') // 让线条圆润\r\n\t\t\t\tthis.drawContext.strokeStyle = this.currentColor; //设置画笔颜色\r\n\t\t\t\tthis.drawContext.setLineWidth(this.lineWidth); //设置画笔粗细\r\n\t\t\t\t//设置背景\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.fillBackground();\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.content {\r\n\t\theight: 100vh;\r\n\t\twidth: 100vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tposition: relative;\r\n\r\n\t\t.draw-logo {\r\n\t\t\twidth: 1.8rem;\r\n\t\t\theight: 1.8rem;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tposition: fixed;\r\n\t\t\tright: 0.1rem;\r\n\t\t\ttop: 0.5rem;\r\n\t\t\tz-index: 10;\r\n\t\t}\r\n\r\n\t\t.pen-box {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 3rem;\r\n\r\n\t\t\t.pen {\r\n\t\t\t\twidth: 3rem;\r\n\t\t\t\tborder-radius: 0.2rem;\r\n\t\t\t}\r\n\r\n\t\t\t.pen-slider {\r\n\t\t\t\twidth: 60%;\r\n\t\t\t}\r\n\r\n\t\t\t.pen-txt {\r\n\t\t\t\tfont-size: 1.2rem;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.tools-box {\r\n\r\n\t\t\t.tools {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tbackground-color: white;\r\n\t\t\t\tborder-radius: 0.2rem 0 0 0.2rem;\r\n\t\t\t\t.tools-item {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\tfont-size: 0.8rem;\r\n\r\n\t\t\t\t\t.tools-icon {\r\n\t\t\t\t\t\twidth: 1.2rem;\r\n\t\t\t\t\t\theight: 1.2rem;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\twidth: 2rem;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.btn-box {\r\n\t\t\tposition: fixed;\r\n\t\t\tbottom: 1.2rem;\r\n\t\t\tmargin: 0 auto;\r\n\t\t\twidth: 33%;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t}\r\n\t}\n\t.under-image {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-size: cover ;\n\t\tbackground-repeat: no-repeat;\n\t}\r\n\r\n\t/* 竖屏 */\r\n\t@media screen and (orientation: portrait) {\r\n\t\t.tools-box {\r\n\t\t\t.tools {\r\n\t\t\t\theight: 3rem;\r\n\t\t\t\tflex-wrap: wrap;\r\n\r\n\t\t\t\t.tools-item {\r\n\t\t\t\t\twidth: 8%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.canvas-box {\r\n\t\t\twidth: 100vw;\r\n\t\t\tposition: relative;\r\n\r\n\t\t\t.board-canvas {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tbackground: rgba(0, 0, 0, 0);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/* 横屏 */\r\n\t@media screen and (orientation: landscape) {\r\n\t\t.tools-box {\r\n\t\t\tposition: fixed;\r\n\t\t\theight: 80vh;\r\n\t\t\tz-index: 10;\r\n\t\t\toverflow: auto;\r\n\t\t\tright: 0;\r\n\r\n\t\t\t.tools {\r\n\t\t\t\twidth: 1.8rem;\r\n\t\t\t\tflex-direction: column;\r\n\r\n\t\t\t\t.tools-item {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tmargin: 0.4rem 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.canvas-box {\r\n\t\t\t//width: calc(100% - 2rem);\r\n\t\t\twidth: 100%;\r\n\t\t\t//margin-right: 2.2rem;\r\n\t\t\tposition: relative;\r\n\r\n\t\t\t.board-canvas {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tbackground: rgba(0, 0, 0, 0);\r\n\t\t\t}\n\t\t\t\r\n\t\t}\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wn-canvas.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Program Files/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./wn-canvas.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1731471870074\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}